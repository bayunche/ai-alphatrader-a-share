{
  "location": {
    "module": "server/index.js",
    "related": [
      "server/schema.sql",
      "package.json",
      "src-tauri/tauri.conf.json"
    ],
    "context": "后端 Express + sqlite3，用作 Tauri sidecar；当前只包含用户/工作区表和行情缓存接口"
  },
  "current_state": {
    "db": {
      "path": "dataDir/database.sqlite（依赖 DATA_DIR 或应用目录）",
      "schema": "内置 users/workspaces 表，schema.sql 为空；没有 a_stock_master / kline 相关表"
    },
    "market_api": {
      "eastmoney": "fetchEastMoneyPage 调用 push2 clist/get，多页抓取后缓存，字段映射为 symbol/name/price 等临时字段",
      "fallback": "fetchYingweiPage 作为兜底，刷新价格 refreshPrices 也只调用英为财经",
      "cache": "marketCache 持内存数据与 total，/api/market 提供分页与关键字过滤"
    },
    "process": "server 启动即建库并加载 schema；无定时任务或单独脚本处理行情入库"
  },
  "tech_stack": {
    "backend": "Node.js + Express + sqlite3 标准库驱动",
    "client": "前端 React/Vite 通过 /api/market 读取缓存",
    "db": "SQLite，本地文件，当前仅基础表"
  },
  "tests": {
    "current": "仓库无自动化测试；server 未附带测试脚本",
    "notes": "需要新增本地验证脚本覆盖行情抓取与 SQLite 落库"
  },
  "observation": {
    "gaps": [
      "缺少 A 股主表与实时行情入库逻辑，无法按要求只刷新价格字段",
      "未定义 Python 抓取脚本和 SQLite 结构，需新增函数与建表流程",
      "kline/get、stock/get 未在后端使用，secid 转换逻辑缺失"
    ],
    "direction": "新增 Python 脚本：全量抓取 clist/get 入库、实时逐只刷新价格、按 secid 拉取日线并 upsert；创建 a_stock_master 与 a_stock_kline_daily 表"
  }
}
